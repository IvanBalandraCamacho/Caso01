# front-v2/Dockerfile.dev
FROM node:20-alpine

WORKDIR /app

# Configurar npm para mejor resiliencia de red
RUN npm config set fetch-retries 5 && \
    npm config set fetch-retry-mintimeout 20000 && \
    npm config set fetch-retry-maxtimeout 120000

# Instalar pnpm globalmente con reintentos
RUN npm install -g pnpm || npm install -g pnpm || npm install -g pnpm

# Copiar archivos de dependencias
COPY package.json pnpm-lock.yaml ./

# Instalar dependencias (frozen-lockfile es más rápido)
RUN pnpm install --frozen-lockfile

# Exponer puerto
EXPOSE 3000

# Comando por defecto (sobrescrito por docker-compose, pero buena práctica)
CMD ["pnpm", "run", "dev", "--turbo"]
